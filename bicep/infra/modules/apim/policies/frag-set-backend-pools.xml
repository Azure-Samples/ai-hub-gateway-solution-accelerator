<fragment>
    <!--
        Fragment: Set Backend Pools
        Purpose: Defines backend pool configurations with their supported models and routing settings
        
        Expected Input Variables:
        - requestedModel: The model name extracted from the request payload
        - defaultBackendPool: Default backend pool to use when model is not mapped (empty string = error for unmapped models)
        - allowedBackendPools: Comma-separated list of allowed backend pool IDs (empty string = all pools allowed)
        
        Output Variables:
        - backendPools: JArray containing all backend pool configurations
    -->
    
    <!-- Define backend pools with their supported models and routing configurations -->
    <set-variable name="backendPools" value="@{
        JArray backendPools = new JArray();
        
        // Update the below if condition when using multiple APIM gateway regions/SHGW to get different configurations for each region
        if(context.Deployment.Region == "All Regions" || true)
        {
            // Backend Pools Configuration (Auto-generated from Bicep deployment)
            //{backendPoolsCode}
        }
        else
        {
            // No backend pools found for selected region
            // Either return error (default behavior) or set default pools in the else section
        }
        
        return backendPools;   
    }" />
</fragment>