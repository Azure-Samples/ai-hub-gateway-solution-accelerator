<fragment>
    <!-- NOTE: emit-tokens has limited support for up to 6 custom dimensions -->
    <!-- Using of optional dimensions require setting up variables before executing the policy fragment -->
    <llm-emit-token-metric namespace="llm-usage">
        <!-- Use case or agentic platform name-->
        <dimension name="productName" value="@(context.Product?.Name?.ToString() ?? "Portal-Admin")" />
        
        <!-- Target model or deployment name -->
        <dimension name="deploymentName" value="@((string)context.Variables.GetValueOrDefault<string>("requestedModel", "DefaultModel"))" />
        
        <!-- This is the backend processed the request-->
        <dimension name="Backend ID" />
        
        <!-- This can be your agent Id or APIM subscription id-->
        <dimension name="appId" value="@((string)context.Variables.GetValueOrDefault<string>("appId", context.Subscription?.Id ?? "Portal-Admin-Sub"))" />

        <!-- CUSTOM DIMENSIONS: Allows defining additional context for LLM usage -->
        <dimension name="customDimension1" value="@((string)context.Variables.GetValueOrDefault<string>("customDimension1", "NA"))" />
        <dimension name="customDimension2" value="@((string)context.Variables.GetValueOrDefault<string>("customDimension2", "NA"))" />

    </llm-emit-token-metric>
</fragment>